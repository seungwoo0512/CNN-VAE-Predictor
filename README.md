
# 임신 성공 여부 예측

## 1. 데이터 정보
- **ID**: 샘플별 고유 ID (256,351 rows)
- **데이터**: 난임 환자 시술 데이터 (67개의 컬럼)
- **임신 성공 여부**:
  - **1**: 임신 성공
  - **0**: 임신 실패

## 2. 실험 배경 및 동기
기존의 tree 모델 및 머신러닝 기반 stacking, voting 앙상블 모델의 성능이 낮았기에,  
CNN을 적용하여 성능 개선을 도모하고자 하였습니다.

## 3. 이미지 변환 및 Target Encoding
데이터를 이미지로 변환하는 과정에서 변수들에 대응하는 
target 변수의 mean을 활용하기로 결정

### 3.1 Target Encoding
- **목적**: 각 변수의 값을 임신 성공 확률로 매핑(target encoding)
- **방법**:
  - **범주형 변수**: 각 범주에 대응되는 임신 성공 확률을 매핑
  - **수치형 변수**: 구간을 나누어 각 구간에 대응되는 임신 성공 확률을 매핑

### 3.2 이미지 생성
- 각 변수의 매핑된 확률값을 픽셀 값으로 채움
- **예시**: 변수1과 변수2가 교차하는 지점에서는, 두 변수의 매핑된 확률값의 합을 해당 픽셀 값으로 설정

> **변환된 이미지 예시**
<div style="display: flex;">
  <img src="https://github.com/user-attachments/assets/135651fa-fe57-4119-8d7f-b788e5d5d2c8" width="300" style="margin-right: 10px;" />
  <img src="https://github.com/user-attachments/assets/b6ef96ee-1ee8-4887-8223-2c52389a6335" width="300" />
</div>

- **왼쪽 (임신 실패 case):** 임신 성공 case에 비해 **주요 변수**들이 **비활성화**되어 있음을 확인할 수 있음.
- **오른쪽 (임신 성공 case):** 나이, 생성 배아 수, 배아 이식 수 등 **주요 변수**들이 **활성화**되어 있음을 확인할 수 있음.

따라서, 생성된 이미지는 분류 가능한 적절한 사례로 판단됩니다.


## 4. 분류 모델 적용
- 생성된 이미지 데이터를 CNN 모델을 통해 연산한 후 flatten 처리하여 기존 분류 모델에 적용함
- 기존 모델 대비 성능 개선이 확인되었으나, 최종 최고 성능은 달성하지 못함

## 5. VAE 기반 특징 추출 및 앙상블 모델
이미지 데이터를 보다 효과적으로 활용하기 위해, VAE를 적용하였습니다.

### 5.1 VAE를 활용한 특징 추출
- **Encoder**: 이미지 데이터를 복원하는데 필요한 latent vector(z)를 추출
- **Decoder**: 원본 이미지와 복원된 이미지의 차이를 확인하여, 추출된 z 벡터의 적절성을 평가

> **[VAE 복원 이미지]**
![image](https://github.com/user-attachments/assets/db954117-26a1-4eba-a32d-e831c46bc8b0)

-적절하게 이미지 복원을 가능하게 하는 z를 추출하였음

### 5.2 PCA 및 CatBoost 활용
- 추출된 **z 벡터**에 대해 PCA를 적용하여 차원을 축소
- 축소된 z 벡터와 원본 변수를 결합하여 CatBoost 모델에 적용
- 이를 통해 최종적으로 최고 성능 달성

## 6. 성능 및 리더보드
- **최종 성능**: ROC-AUC 0.7471
- **리더보드 순위(private)**: 123/1500(8%)

## 7. 결론
본 프로젝트에서는 불균형 데이터 문제와 기존 모델의 낮은 성능 문제를 해결하기 위해,  
데이터를 이미지로 변환하고 CNN 및 VAE를 활용한 특징 추출을 수행하였습니다.  
이후, PCA로 차원 축소된 z 벡터와 원본 변수를 결합하여 CatBoost 모델에 적용함으로써,  
최종적으로 성능 개선 및 최고 성능 달성을 이뤄냈습니다.
